{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\scripts\\sspgame/assets\\scripts\\sspgame\\SSPGameResult.js"],"names":["cc","Class","extends","Component","properties","_gameresult","_seats","onLoad","vv","node","getChildByName","seats","i","children","length","push","getComponent","btnClose","find","utils","addClickEvent","btnWeiClose","btnWei_haoyou","btnWei_pengyouquan","btnShare","self","on","data","onGameEnd","detail","showResult","seat","info","isZuiJiaPaoShou","Label","string","win","lose","draw","endinfo","sspNetMgr","maxscore","maxdianpao","dianpaogaoshou","score","userid","isBigwin","setInfo","name","setID","onBtnCloseClicked","wc","show","director","loadScene","onBtnShareClicked","share","active","onBtnShareCloseClicked","onBtnShareHaoyou","sys","browserType","console","log","anysdkMgr","getAccess_token","os","OS_ANDROID","OS_IOS","shareResult","onBtnSharePengyouquan"],"mappings":"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","file":"SSPGameResult.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\sspgame","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //    default: null,\r\n        //    url: cc.Texture2D,  // optional, default is typeof default\r\n        //    serializable: true, // optional, default is true\r\n        //    visible: true,      // optional, default is true\r\n        //    displayName: 'Foo', // optional\r\n        //    readonly: false,    // optional, default is false\r\n        // },\r\n        // ...\r\n        _gameresult:null,\r\n        _seats:[],\r\n    },\r\n\r\n    // use this for initialization\r\n    onLoad: function () {\r\n        if(cc.vv == null){\r\n            return;\r\n        }\r\n        \r\n        this._gameresult = this.node.getChildByName(\"game_result\");\r\n        \r\n        var seats = this._gameresult.getChildByName(\"seats\");\r\n        for(var i = 0; i < seats.children.length; ++i){\r\n            this._seats.push(seats.children[i].getComponent(\"sspSeat\"));   \r\n        }\r\n        \r\n        var btnClose = cc.find(\"Canvas/game_result/btnClose\");\r\n        if(btnClose){\r\n            cc.vv.utils.addClickEvent(btnClose,this.node,\"SSPGameResult\",\"onBtnCloseClicked\");\r\n        }\r\n\r\n        var btnWeiClose = cc.find(\"Canvas/share/btn_close\");\r\n        if(btnWeiClose){\r\n            cc.vv.utils.addClickEvent(btnWeiClose,this.node,\"SSPGameResult\",\"onBtnShareCloseClicked\");\r\n        }\r\n\r\n        var btnWei_haoyou = cc.find(\"Canvas/share/Wei_haoyou\");\r\n        if(btnWei_haoyou){\r\n            cc.vv.utils.addClickEvent(btnWei_haoyou,this.node,\"SSPGameResult\",\"onBtnShareHaoyou\");\r\n        }\r\n\r\n        var btnWei_pengyouquan = cc.find(\"Canvas/share/Wei_pengyouquan\");\r\n        if(btnWei_pengyouquan){\r\n            cc.vv.utils.addClickEvent(btnWei_pengyouquan,this.node,\"SSPGameResult\",\"onBtnSharePengyouquan\");\r\n        }\r\n        \r\n        var btnShare = cc.find(\"Canvas/game_result/btnShare\");\r\n        if(btnShare){\r\n            cc.vv.utils.addClickEvent(btnShare,this.node,\"SSPGameResult\",\"onBtnShareClicked\");\r\n        }\r\n        \r\n        //初始化网络事件监听器\r\n        var self = this;\r\n        this.node.on('game_end',function(data){self.onGameEnd(data.detail);});\r\n    },\r\n    \r\n    showResult:function(seat,info,isZuiJiaPaoShou){\r\n        \r\n        seat.node.getChildByName(\"win\").getComponent(cc.Label).string = info.win;\r\n        seat.node.getChildByName(\"lose\").getComponent(cc.Label).string = info.lose;\r\n        seat.node.getChildByName(\"draw\").getComponent(cc.Label).string = info.draw;\r\n    },\r\n    \r\n    onGameEnd:function(endinfo){\r\n        var seats = cc.vv.sspNetMgr.seats;\r\n        var maxscore = -1;\r\n        var maxdianpao = 0;\r\n        var dianpaogaoshou = -1;\r\n        for(var i = 0; i < seats.length; ++i){\r\n            var seat = seats[i];\r\n            if(seat.score > maxscore){\r\n                maxscore = seat.score;\r\n            }\r\n        }\r\n        \r\n        for(var i = 0; i < seats.length; ++i){\r\n            if (seats[i].userid === 0) {\r\n                continue;\r\n            }\r\n            var seat = seats[i];\r\n            var isBigwin = false;\r\n            if(seat.score > 0){\r\n                isBigwin = seat.score == maxscore;\r\n            }\r\n            this._seats[i].setInfo(seat.name,endinfo[i].score, isBigwin);\r\n            this._seats[i].setID(seat.userid);\r\n            var isZuiJiaPaoShou = dianpaogaoshou == i;\r\n            this.showResult(this._seats[i],endinfo[i],isZuiJiaPaoShou);\r\n        }\r\n    },\r\n    \r\n    onBtnCloseClicked:function(){\r\n        cc.vv.wc.show('正在返回游戏大厅');\r\n        cc.director.loadScene(\"hall\");\r\n    },\r\n    \r\n    onBtnShareClicked:function(){\r\n        var share = cc.find(\"Canvas/share\");\r\n        share.active = true;\r\n    },\r\n    onBtnShareCloseClicked:function(){\r\n        var share = cc.find(\"Canvas/share\");\r\n        share.active = false;\r\n    },\r\n    onBtnShareHaoyou:function(){\r\n        var share = cc.find(\"Canvas/share\");\r\n        share.active = false;\r\n        //微信浏览器----公众号登录 \r\n        if(cc.sys.browserType == \"mqqbrowser\" || \"wechat\" == cc.sys.browserType){\r\n            console.log(\"H5分享好友\");\r\n            cc.find(\"Canvas/WebShare\").active = true;\r\n            cc.vv.anysdkMgr.getAccess_token('好玩的棋牌游戏');\r\n        }\r\n        else if(cc.sys.os == cc.sys.OS_ANDROID || cc.sys.os == cc.sys.OS_IOS){\r\n            cc.vv.anysdkMgr.shareResult('0');\r\n        }\r\n        //其它浏览器----二维码扫码登录 \r\n        else{\r\n            console.log(\"H5分享好友\");\r\n            cc.find(\"Canvas/WebShare\").active = true;\r\n            cc.vv.anysdkMgr.getAccess_token('好玩的棋牌游戏');\r\n        }\r\n    },\r\n    onBtnSharePengyouquan:function(){\r\n        var share = cc.find(\"Canvas/share\");\r\n        share.active = false;\r\n        //微信浏览器----公众号登录 \r\n        if(cc.sys.browserType == \"mqqbrowser\" || \"wechat\" == cc.sys.browserType){\r\n            console.log(\"H5分享好友\");\r\n            cc.find(\"Canvas/WebShare\").active = true;\r\n            cc.vv.anysdkMgr.getAccess_token('好玩的棋牌游戏');\r\n        }\r\n        else if(cc.sys.os == cc.sys.OS_ANDROID || cc.sys.os == cc.sys.OS_IOS){\r\n            cc.vv.anysdkMgr.shareResult('1');\r\n        }\r\n        //其它浏览器----二维码扫码登录 \r\n        else{\r\n            console.log(\"H5分享好友\");\r\n            cc.find(\"Canvas/WebShare\").active = true;\r\n            cc.vv.anysdkMgr.getAccess_token('好玩的棋牌游戏');\r\n        }\r\n    },\r\n});\r\n"]}