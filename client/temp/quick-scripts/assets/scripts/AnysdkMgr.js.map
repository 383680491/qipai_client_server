{"version":3,"sources":["AnysdkMgr.js"],"names":["cc","Class","extends","Component","properties","_isCapturing","onLoad","jquery","window","jQuery","init","ANDROID_API","IOS_API","getBatteryPercent","sys","isNative","os","OS_ANDROID","OS_IOS","login","console","log","share","title","desc","shareResult","to","size","director","getWinSize","fileName","fullPath","jsb","fileUtils","getWritablePath","isFileExist","removeFile","texture","RenderTexture","Math","floor","width","height","setPosition","p","begin","getRunningScene","visit","end","saveToFile","IMAGE_FORMAT_JPG","Name","origin","getVisibleOrigin","tex","fullRect","Rect","x","y","virtualViewPort","setVirtualViewport","self","tryTimes","fn","shareImg","setTimeout","shareUrlEvent","agent","anysdk","agentManager","share_plugin","getSharePlugin","setListener","onShareResult","shareUrl","onLoginResp","data","ret","errcode","localStorage","setItem","account","sign","vv","userMgr","onAuth","http","sendRequest","imgPath","map","mediaType","shareTo","imagePath","thumbImage","url","text","code","msg","ShareResultCode","kShareSuccess","kShareFail","kShareCancel","kShareNetworkError","thumbSize","getAccess_token","roomid","isgetToken","token","access_token","browserType","APPID","SECRET","wxUrl","ajax","type","cache","success","Data","Json_Data","JSON","parse","errmsg","undefined","expires_in","getsignature","error","sha1","require","timestamp","Date","now","noncestr","jsapi_ticket","ticket","location","href","split","string1","signature","H5share","imgUrl","jssdk","document","createElement","async","src","body","appendChild","appId","nonceStr","addEventListener","wx","config","debug","jsApiList","ready","onMenuShareAppMessage","link","dataUrl","cancel","fail","res","onMenuShareTimeline","i"],"mappings":"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","file":"AnysdkMgr.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //    default: null,      // The default value will be used only when the component attaching\r\n        //                           to a node for the first time\r\n        //    url: cc.Texture2D,  // optional, default is typeof default\r\n        //    serializable: true, // optional, default is true\r\n        //    visible: true,      // optional, default is true\r\n        //    displayName: 'Foo', // optional\r\n        //    readonly: false,    // optional, default is false\r\n        // },\r\n        // ...\r\n        _isCapturing:false,\r\n    },\r\n\r\n    // use this for initialization\r\n    onLoad: function () {\r\n        this.jquery = window.jQuery;\r\n    },\r\n\r\n    // called every frame, uncomment this function to activate update callback\r\n    // update: function (dt) {\r\n\r\n    // },\r\n    \r\n    init:function(){\r\n        this.ANDROID_API = \"com/babykylin/NativeAPI\";\r\n        this.IOS_API = \"AppController\";\r\n\r\n        //if(cc.sys.browserType == \"mqqbrowser\" || \"wechat\" == cc.sys.browserType){\r\n            //this.getsignature();\r\n        //}\r\n        \r\n    },\r\n\r\n    getBatteryPercent:function(){\r\n        if(cc.sys.isNative){\r\n            if(cc.sys.os == cc.sys.OS_ANDROID){\r\n                //return jsb.reflection.callStaticMethod(this.ANDROID_API, \"getBatteryPercent\", \"()F\");\r\n            }\r\n            else if(cc.sys.os == cc.sys.OS_IOS){\r\n                //return jsb.reflection.callStaticMethod(this.IOS_API, \"getBatteryPercent\");\r\n            }            \r\n        }\r\n        return 0.9;\r\n    },\r\n    \r\n    login:function(){\r\n        if(cc.sys.os == cc.sys.OS_ANDROID){ \r\n            //jsb.reflection.callStaticMethod(this.ANDROID_API, \"Login\", \"()V\");\r\n        }\r\n        else if(cc.sys.os == cc.sys.OS_IOS){\r\n            //jsb.reflection.callStaticMethod(this.IOS_API, \"login\");\r\n        }\r\n        else{\r\n            console.log(\"platform:\" + cc.sys.os + \" dosn't implement share.\");\r\n        }\r\n    },\r\n    \r\n    share:function(title,desc){\r\n        if(cc.sys.os == cc.sys.OS_ANDROID){\r\n            //jsb.reflection.callStaticMethod(this.ANDROID_API, \"Share\", \"(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V\",cc.vv.SI.appweb,title,desc);\r\n        }\r\n        else if(cc.sys.os == cc.sys.OS_IOS){\r\n            //jsb.reflection.callStaticMethod(this.IOS_API, \"share:shareTitle:shareDesc:\",cc.vv.SI.appweb,title,desc);\r\n        }\r\n        else{\r\n            console.log(\"platform:\" + cc.sys.os + \" dosn't implement share.\");\r\n        }\r\n    },\r\n    \r\n    // shareResult:function(){\r\n    //     if(this._isCapturing){\r\n    //         return;\r\n    //     }\r\n    //     this._isCapturing = true;\r\n    //     var size = cc.director.getWinSize();\r\n    //     var currentDate = new Date();\r\n    //     var fileName = \"result_share.jpg\";\r\n    //     var fullPath = jsb.fileUtils.getWritablePath() + fileName;\r\n    //     if(jsb.fileUtils.isFileExist(fullPath)){\r\n    //         jsb.fileUtils.removeFile(fullPath);\r\n    //     }\r\n    //     var texture = new cc.RenderTexture(Math.floor(size.width), Math.floor(size.height));\r\n    //     texture.setPosition(cc.p(size.width/2, size.height/2));\r\n    //     texture.begin();\r\n    //     cc.director.getRunningScene().visit();\r\n    //     texture.end();\r\n    //     texture.saveToFile(fileName, cc.IMAGE_FORMAT_JPG);\r\n    //     console.log('fullPath: ' + fullPath);\r\n    //     var self = this;\r\n    //     var tryTimes = 0;\r\n    //     var fn = function(){\r\n    //         if(jsb.fileUtils.isFileExist(fullPath)){\r\n    //             var height = 100;\r\n    //             var scale = height/size.height;\r\n\t\t\t //    var width = Math.floor(size.width * scale);\r\n    //             console.log('SSSSSSSSSSSSSSSS: ' + fullPath);\r\n    //             if(cc.sys.os == cc.sys.OS_ANDROID){\r\n    //                 //jsb.reflection.callStaticMethod(self.ANDROID_API, \"ShareIMG\", \"(Ljava/lang/String;II)V\",fullPath,width,height);\r\n    //             }\r\n    //             else if(cc.sys.os == cc.sys.OS_IOS){\r\n    //                 jsb.reflection.callStaticMethod(self.IOS_API, \"shareIMG:width:height:\",fullPath,width,height);\r\n    //             }\r\n    //             else{\r\n    //                 console.log(\"platform:\" + cc.sys.os + \" dosn't implement share.\");\r\n    //             }\r\n    //             self._isCapturing = false;\r\n    //         }\r\n    //         else{\r\n    //             tryTimes++;\r\n    //             if(tryTimes > 10){\r\n    //                 console.log(\"time out...\");\r\n    //                 return;\r\n    //             }\r\n    //             setTimeout(fn,50); \r\n    //         }\r\n    //     }\r\n    //     setTimeout(fn,50);\r\n    // },\r\n    shareResult:function(to){\r\n        if(this._isCapturing){\r\n            return;\r\n        }\r\n        this._isCapturing = true;\r\n        var size = cc.director.getWinSize();\r\n        var fileName = \"result_share.jpg\";\r\n        var fullPath = jsb.fileUtils.getWritablePath() + fileName;\r\n        if(jsb.fileUtils.isFileExist(fullPath)){\r\n            jsb.fileUtils.removeFile(fullPath);\r\n        }\r\n        var texture = new cc.RenderTexture(Math.floor(size.width), Math.floor(size.height));\r\n        texture.setPosition(cc.p(size.width/2, size.height/2));\r\n        texture.begin();\r\n        cc.director.getRunningScene().visit();\r\n        texture.end();\r\n        texture.saveToFile(fileName, cc.IMAGE_FORMAT_JPG);\r\n        console.log('fullPath: ' + fullPath);\r\n        \r\n        \r\n        var Name = \"share.jpg\";\r\n        var origin = cc.director.getVisibleOrigin();\r\n        var tex = new cc.RenderTexture(Math.floor(size.width), Math.floor(size.height));\r\n        var fullRect = new cc.Rect(origin.x, origin.y, size.width*0.5, size.height*0.5); \r\n        var virtualViewPort = new cc.Rect(size.width*0.25, size.height*0.25, size.width*0.5, size.height*0.5); \r\n        tex.setVirtualViewport(cc.p(size.width*0.25, size.height*0.25),fullRect,virtualViewPort); \r\n        tex.begin();\r\n        cc.director.getRunningScene().visit();\r\n        tex.end();\r\n        tex.saveToFile(Name, cc.IMAGE_FORMAT_JPG);\r\n        \r\n        \r\n        var self = this;\r\n        var tryTimes = 0;\r\n        var fn = function(){\r\n            if(jsb.fileUtils.isFileExist(fullPath)){\r\n                self.shareImg(fullPath,to);\r\n                self._isCapturing = false;\r\n            }\r\n            else{\r\n                tryTimes++;\r\n                if(tryTimes > 10){\r\n                    console.log(\"time out...\");\r\n                    return;\r\n                }\r\n                setTimeout(fn,50); \r\n            }\r\n        }\r\n        setTimeout(fn,50);\r\n    },\r\n\r\n    //分享url事件\r\n    shareUrlEvent:function(to){\r\n        var agent = anysdk.agentManager;\r\n        this.share_plugin = agent.getSharePlugin();\r\n        this.share_plugin.setListener(this.onShareResult, this);\r\n        this.shareUrl(\"斗斗棋牌\",\"斗斗棋牌，包含了福州麻将、十三水等多种玩法。\",\"www.doudouyule.wang/wap/page/share\",'http://game.doudouyule.wang/icon.png',to);\r\n    },\r\n    /*\r\n    /*\r\n    onLoginResp:function(code){\r\n        var fn = function(ret){\r\n            if(ret.errcode == 0){\r\n                cc.sys.localStorage.setItem(\"wx_account\",ret.account);\r\n                cc.sys.localStorage.setItem(\"wx_sign\",ret.sign);\r\n            }\r\n            console.log('ret123: ' + ret);\r\n            console.log('errcode: ' + ret.errcode);\r\n            console.log('errmsg: ' + ret.errmsg);\r\n            console.log('account: ' + ret.account);\r\n            console.log('halladdr: ' + ret.halladdr);\r\n            console.log('sign: ' + ret.sign);\r\n            cc.vv.userMgr.onAuth(ret);\r\n        }\r\n        \r\n        cc.vv.http.sendRequest(\"/wechat_auth\",{code:code,os:cc.sys.os},fn);\r\n    },\r\n    */\r\n   \r\n    onLoginResp:function(data){\r\n        var fn = function(ret){\r\n            if(ret.errcode == 0){\r\n                cc.sys.localStorage.setItem(\"wx_account\",ret.account);\r\n                cc.sys.localStorage.setItem(\"wx_sign\",ret.sign);\r\n            }\r\n\r\n            cc.vv.userMgr.onAuth(ret);\r\n        }\r\n        \r\n        cc.vv.http.sendRequest(\"/wechat_auth\",data,fn);\r\n    },\r\n\r\n    shareImg:function(imgPath,to){\r\n        console.log('分享图片: ');\r\n        var agent = anysdk.agentManager;\r\n        this.share_plugin = agent.getSharePlugin();\r\n        this.share_plugin.setListener(this.onShareResult, this);\r\n        \r\n        if(jsb.fileUtils.isFileExist(imgPath)){\r\n            console.log(\"isFileExist3333333333333\");\r\n            //jsb.fileUtils.removeFile(fullPath);\r\n        }\r\n        console.log('imgPath: ' + imgPath);\r\n        var map ={\r\n            mediaType : '1',//分享类型\r\n            shareTo : to,//分享至 0 聊天 1 朋友圈 2 收藏\r\n            imagePath : imgPath,//图片路径\r\n            thumbImage : jsb.fileUtils.getWritablePath() +'share.jpg',//图片路径\r\n            title : '斗斗福建十三水',//标题\r\n            url   : 'http://120.77.56.190:3000/web-mobile/index.html',//链接\r\n            text  : '棋牌'//文本\r\n        }\r\n        this.share_plugin.share(map);\r\n    },\r\n    //分享事件\r\n    onShareResult:function(code, msg){\r\n        console.log('111111111111111111111111111111111111');\r\n        console.log(\"share result, resultcode:\"+code+\", msg: \"+msg);\r\n        switch ( code ) {\r\n            case anysdk.ShareResultCode.kShareSuccess:\r\n                //do something\r\n                console.log('分享成功');\r\n                break;\r\n            case anysdk.ShareResultCode.kShareFail:\r\n                //do something\r\n                console.log('分享失败');\r\n                break;\r\n            case anysdk.ShareResultCode.kShareCancel:\r\n                //do something\r\n                console.log('分享取消');\r\n                break;\r\n            case anysdk.ShareResultCode.kShareNetworkError:\r\n                //do something\r\n                console.log('分享错误');\r\n                break;\r\n        }\r\n    },\r\n    //分享URL\r\n    shareUrl:function(title,text,url,imagePath,to){\r\n        console.log('分享URL: ');\r\n        console.log('title: ' + title);\r\n        console.log('text: ' + text);\r\n        console.log('url: ' + url);\r\n        console.log('imagePath: ' + imagePath);\r\n        console.log('to: ' + to);\r\n        var map ={\r\n            title : title,//标题\r\n            text  : text,//文本\r\n            url   : url,//链接\r\n            mediaType : '2',//分享类型\r\n            shareTo : to,//分享至 0 聊天 1 朋友圈 2 收藏\r\n            imagePath : imagePath,//图片路径\r\n            thumbSize : '64',//安卓用\r\n            thumbImage: jsb.fileUtils.getWritablePath() +'share.jpg',//苹果用\r\n        }\r\n        this.share_plugin.share(map);\r\n    },\r\n\r\n    getAccess_token:function(desc,roomid){ //获取签名\r\n        this.jquery = window.jQuery;\r\n        var self = this;\r\n        var fn = function(ret){\r\n            if(ret){\r\n               var isgetToken = ret.errcode.isgetToken;\r\n               console.log('isgetToken: ' + isgetToken);\r\n               self.token(isgetToken,desc,roomid);\r\n            }\r\n        }\r\n        var data = {\r\n            \r\n        };\r\n        \r\n        cc.vv.http.sendRequest(\"/H5getToken\",data,fn);//获取分享的access_token   \r\n        \r\n    },\r\n\r\n    token:function(isgetToken,desc,roomid){\r\n        var self = this;\r\n\r\n        if(!self.access_token ||　isgetToken){\r\n            if(cc.sys.browserType == \"mqqbrowser\" || \"wechat\" == cc.sys.browserType){\r\n                console.log(\"cc.sys.browserType == mqqbrowser || wechat == cc.sys.browserType\");\r\n                var APPID = \"wxc79611510593f0ca\";\r\n                var SECRET = \"897da32742b97e684d6fe1d78dac03ee\";\r\n            }\r\n            //其它浏览器----二维码扫码登录 \r\n            else{\r\n                console.log(\"其它浏览器----二维码扫码登录\");\r\n                var APPID = \"wx7f3748cc28cd072c\";\r\n                var SECRET = \"4fc49e95d9e8cabfa749429fcda31974\";\r\n            }\r\n            var wxUrl = \"http://game.doudouyule.wang/getH5shareToken.php?APPID=\"+APPID+\"&SECRET=\"+SECRET;\r\n            console.log(\"H5shawxUrl:\"+wxUrl);\r\n            this.jquery.ajax({\r\n                type:\"POST\",\r\n                url:wxUrl,\r\n                cache:false,\r\n                success:function(Data){\r\n                    console.log('H5_WXshareGetToken success:'+Data);\r\n                    var Json_Data = JSON.parse(Data);\r\n                    var errmsg = Json_Data.errmsg;\r\n                    if(errmsg == undefined){\r\n                        self.access_token = Json_Data.access_token;\r\n                        var expires_in = Json_Data.expires_in;//有效时间\r\n                        console.log('self.H5access_token:'+self.access_token);\r\n                        console.log('expires_in:'+expires_in);\r\n                        self.getsignature(self.access_token,desc,roomid);\r\n                    }\r\n                    else{\r\n                        console.log('errmsg != undefined');\r\n                    }\r\n                },\r\n                error:function(data){\r\n                    console.log('error');\r\n                    console.log(data);\r\n                }\r\n            });\r\n        }\r\n        else{\r\n            self.getsignature(self.access_token,desc,roomid);\r\n        }\r\n    },\r\n\r\n    getsignature:function(access_token,desc,roomid){\r\n        var self = this;\r\n        var sha1 = require(\"sha1\");\r\n        this.timestamp = Math.floor(Date.now()/1000); //精确到秒\r\n        var timestamp = this.timestamp;\r\n        console.log('timestamp: ' + timestamp);\r\n        var noncestr = \"Wm3WZYTPz0wzccnW\";\r\n        if(timestamp > 0){\r\n            var wxUrl = \"http://game.doudouyule.wang/getticket.php?access_token=\"+access_token;\r\n            console.log(\"wxUrl:\"+wxUrl);\r\n            this.jquery.ajax({\r\n                type:\"POST\",\r\n                url:wxUrl,\r\n                cache:false,\r\n                success:function(Data){\r\n                    console.log('H5_WXGetToken success12:'+Data);\r\n\r\n                    // var starStr = Data.indexOf('{');\r\n                    // var endStr = Data.indexOf('}');\r\n                    // var Data = Data.slice(starStr-1);\r\n                    // console.log('Data.slice12:'+Data);\r\n\r\n                    var Json_Data = JSON.parse(Data);\r\n                    self.jsapi_ticket = Json_Data.ticket;\r\n                    console.log('jsapi_ticket:'+self.jsapi_ticket);\r\n                    var url = location.href.split('#')[0];\r\n\r\n                    var string1 = \"jsapi_ticket=\"+self.jsapi_ticket+\"&noncestr=\"+noncestr+\"&timestamp=\"+timestamp+\"&url=\"+url;\r\n\r\n                    console.log('&noncestr=: ' + noncestr);\r\n                    console.log('&timestamp: ' + timestamp);\r\n                    console.log('&url: ' + url);\r\n\r\n                    var signature = sha1(string1);\r\n                    console.log('signature: ' + signature);\r\n                    self.signature =  signature;\r\n                    self.H5share(desc,\"http://game.doudouyule.wang/icon.png\",roomid);\r\n                },\r\n                error:function(data){\r\n                    console.log('error');\r\n                    console.log(data);\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    H5share:function(desc,imgUrl,roomid){\r\n        console.log('this.timestamp:'+this.timestamp);\r\n        console.log('this.signature:'+this.signature);\r\n        console.log('分享.roomid:'+roomid);\r\n        \r\n        var jssdk = document.createElement('script');  //分享\r\n        jssdk.async = true;\r\n        jssdk.src ='http://res.wx.qq.com/open/js/jweixin-1.2.0.js';\r\n        document.body.appendChild(jssdk);\r\n        /*---------JSSDK初始化-----------*/\r\n        \r\n        var data = {\r\n            appId:'wxc79611510593f0ca',\r\n            timestamp:this.timestamp,\r\n            nonceStr:\"Wm3WZYTPz0wzccnW\",\r\n            signature:this.signature,\r\n        }\r\n\r\n        jssdk.addEventListener('load',function(){\r\n            wx.config({\r\n                debug: false,\r\n                appId: data.appId, // 必填，公众号的唯一标识\r\n                timestamp: data.timestamp, // 必填，生成签名的时间戳\r\n                nonceStr: data.nonceStr, // 必填，生成签名的随机串\r\n                signature: data.signature, // 必填，签名，见附录1\r\n                jsApiList: [\r\n                    'checkJsApi',\r\n                    'onMenuShareTimeline',//分享到朋友圈\r\n                    'onMenuShareAppMessage',//发送给朋友\r\n                ] // 必填，需要使用的JS接口列表，所有JS接口列表见附录2\r\n            });\r\n            wx.ready(function(){\r\n                console.log('1111444444444');\r\n               console.log('1分享给朋友');\r\n                wx.onMenuShareAppMessage({  //分享给朋友\r\n                    title: \"斗斗福建十三水\", // 分享标题\r\n                    desc: desc, // 分享描述\r\n                    link: \"http://game.doudouyule.wang/?roomId=\"+roomid, // 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致\r\n                    imgUrl: imgUrl, // 分享图标\r\n                    type: \"\", // 分享类型,music、video或link，不填默认为link\r\n                    dataUrl: \"\", // 如果type是music或video，则要提供数据链接，默认为空\r\n                    success: function () { \r\n                        console.log('1分享给朋友success');\r\n                        // 用户确认分享后执行的回调函数\r\n                    },\r\n                    cancel: function () { \r\n                        console.log('1分享给朋友cancel');\r\n                        // 用户取消分享后执行的回调函数\r\n                    },\r\n                    fail: function (res) {\r\n                        console.log('1分享给朋友fail'+res);\r\n                    }\r\n                });\r\n                console.log('1分享到朋友圈');\r\n                wx.onMenuShareTimeline({   //分享到朋友圈\r\n                    title: '斗斗福建十三水', // 分享标题\r\n                    link: \"http://game.doudouyule.wang/\", // 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致\r\n                    imgUrl: imgUrl, // 分享图标\r\n                    success: function () { \r\n                        // 用户确认分享后执行的回调函数\r\n                    },\r\n                    cancel: function () { \r\n                        // 用户取消分享后执行的回调函数\r\n                    }\r\n                });    \r\n            });\r\n            wx.error(function(res){\r\n                console.log('111144444444455');\r\n                console.log('res: ' + res);\r\n                console.log('111144444444455');\r\n                var i = 0;\r\n            });\r\n        });\r\n\r\n    },\r\n});\r\n"]}