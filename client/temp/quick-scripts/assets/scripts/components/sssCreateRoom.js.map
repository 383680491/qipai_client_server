{"version":3,"sources":["sssCreateRoom.js"],"names":["cc","Class","extends","Component","properties","onLoad","onBtnCreateClicked","node","active","createRoom","getSelectedOfRadioGroup","groupRoot","console","log","game_list","getChildByName","t","arr","i","children","length","n","getComponent","push","selected","checked","self","onCreate","ret","errcode","vv","wc","hide","alert","show","sssNetMgr","connectGameServer","conf","constructSCMJConf","data","account","userMgr","sign","serverType","JSON","stringify","http","sendRequest","difen","koufeixuanze","wanfaxuanze","jushuxuanze","wanfa","onBtnCloseClicked"],"mappings":";;;;;;AAAAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAVQ,KAHP;;AAgBL;AACAC,YAAQ,kBAAY,CAEnB,CAnBI;AAoBLC,wBAAmB,8BAAU;AACzB,aAAKC,IAAL,CAAUC,MAAV,GAAmB,KAAnB;AACA,aAAKC,UAAL;AACH,KAvBI;AAwBLC,2BAxBK,mCAwBmBC,SAxBnB,EAwB8B;AAC/BC,gBAAQC,GAAR,CAAYF,SAAZ;AACA,YAAIG,YAAY,KAAKP,IAAL,CAAUQ,cAAV,CAAyB,WAAzB,CAAhB;AACA,YAAIC,IAAIF,UAAUC,cAAV,CAAyBJ,SAAzB,CAAR;;AAEA,YAAIM,MAAM,EAAV;AACA,aAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIF,EAAEG,QAAF,CAAWC,MAA/B,EAAuC,EAAEF,CAAzC,EAA4C;AACxC,gBAAIG,IAAIL,EAAEG,QAAF,CAAWD,CAAX,EAAcI,YAAd,CAA2B,aAA3B,CAAR;AACA,gBAAID,KAAK,IAAT,EAAe;AACXJ,oBAAIM,IAAJ,CAASF,CAAT;AACH;AACJ;AACD,YAAIG,WAAW,CAAf;AACA,aAAK,IAAIN,IAAI,CAAb,EAAgBA,IAAID,IAAIG,MAAxB,EAAgC,EAAEF,CAAlC,EAAqC;AACjC,gBAAID,IAAIC,CAAJ,EAAOO,OAAX,EAAoB;AAChBD,2BAAWN,CAAX;AACA;AACH;AACJ;AACD,eAAOM,QAAP;AACH,KA5CI;;AA6CLf,gBAAY,sBAAY;AACpB,YAAIiB,OAAO,IAAX;AACA,YAAIC,WAAW,SAAXA,QAAW,CAAUC,GAAV,EAAe;AAC1B,gBAAIA,IAAIC,OAAJ,KAAgB,CAApB,EAAuB;AACnB7B,mBAAG8B,EAAH,CAAMC,EAAN,CAASC,IAAT;AACA;AACA,oBAAIJ,IAAIC,OAAJ,IAAe,IAAnB,EAAyB;AACrB7B,uBAAG8B,EAAH,CAAMG,KAAN,CAAYC,IAAZ,CAAiB,IAAjB,EAAuB,cAAvB;AACH,iBAFD,MAGK;AACDlC,uBAAG8B,EAAH,CAAMG,KAAN,CAAYC,IAAZ,CAAiB,IAAjB,EAAuB,gBAAgBN,IAAIC,OAA3C;AACH;AACJ,aATD,MAUK;AACD7B,mBAAG8B,EAAH,CAAMK,SAAN,CAAgBC,iBAAhB,CAAkCR,GAAlC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACH;AACJ,SA3BD;;AA6BA,YAAIS,OAAO,IAAX;AACAA,eAAO,KAAKC,iBAAL,EAAP;;AAEA,YAAIC,OAAO;AACPC,qBAASxC,GAAG8B,EAAH,CAAMW,OAAN,CAAcD,OADhB;AAEPE,kBAAM1C,GAAG8B,EAAH,CAAMW,OAAN,CAAcC,IAFb;AAGPC,wBAAW,iBAHJ;AAIPN,kBAAMO,KAAKC,SAAL,CAAeR,IAAf;AAJC,SAAX;AAMAzB,gBAAQC,GAAR,CAAY0B,IAAZ;AACAvC,WAAG8B,EAAH,CAAMC,EAAN,CAASG,IAAT,CAAc,QAAd;AACAlC,WAAG8B,EAAH,CAAMgB,IAAN,CAAWC,WAAX,CAAuB,sBAAvB,EAA+CR,IAA/C,EAAqDZ,QAArD;AACH,KAxFI;AAyFLW,uBAAmB,6BAAY;AAC3B,YAAIxB,YAAY,KAAKP,IAAL,CAAUQ,cAAV,CAAyB,WAAzB,CAAhB;;AAEA,YAAIiC,QAAQ,KAAKtC,uBAAL,CAA6B,aAA7B,CAAZ;AACA,YAAIuC,eAAe,KAAKvC,uBAAL,CAA6B,cAA7B,CAAnB;AACA;AACA,YAAIwC,cAAc,KAAKxC,uBAAL,CAA6B,aAA7B,CAAlB;AACA;AACAsC,gBAAQ,CAAR;AACA,YAAIG,cAAc,CAAlB;AACA,YAAId,OAAO;AACPW,mBAAMA,KADC;AAEPG,yBAAYA,WAFL;AAGPC,mBAAMF,WAHC;AAIPD,0BAAaA;AAJN,SAAX;AAMA,eAAOZ,IAAP;AACH,KA1GI;;AA4GLgB,uBAAkB,6BAAU;AACvB,aAAK9C,IAAL,CAAUC,MAAV,GAAmB,KAAnB;AACJ;;AAED;AACA;;AAEA;AAnHK,CAAT","file":"sssCreateRoom.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\components","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //    default: null,      // The default value will be used only when the component attaching\r\n        //                           to a node for the first time\r\n        //    url: cc.Texture2D,  // optional, default is typeof default\r\n        //    serializable: true, // optional, default is true\r\n        //    visible: true,      // optional, default is true\r\n        //    displayName: 'Foo', // optional\r\n        //    readonly: false,    // optional, default is false\r\n        // },\r\n        // ...\r\n    },\r\n\r\n    // use this for initialization\r\n    onLoad: function () {\r\n\r\n    },\r\n    onBtnCreateClicked:function(){\r\n        this.node.active = false;\r\n        this.createRoom();\r\n    },\r\n    getSelectedOfRadioGroup(groupRoot) {\r\n        console.log(groupRoot);\r\n        var game_list = this.node.getChildByName(\"game_list\");\r\n        var t = game_list.getChildByName(groupRoot);\r\n\r\n        var arr = [];\r\n        for (var i = 0; i < t.children.length; ++i) {\r\n            var n = t.children[i].getComponent(\"RadioButton\");\r\n            if (n != null) {\r\n                arr.push(n);\r\n            }\r\n        }\r\n        var selected = 0;\r\n        for (var i = 0; i < arr.length; ++i) {\r\n            if (arr[i].checked) {\r\n                selected = i;\r\n                break;\r\n            }\r\n        }\r\n        return selected;\r\n    },\r\n    createRoom: function () {\r\n        var self = this;\r\n        var onCreate = function (ret) {\r\n            if (ret.errcode !== 0) {\r\n                cc.vv.wc.hide();\r\n                //console.log(ret.errmsg);\r\n                if (ret.errcode == 2222) {\r\n                    cc.vv.alert.show(\"提示\", \"钻石不足，创建房间失败!\");\r\n                }\r\n                else {\r\n                    cc.vv.alert.show(\"提示\", \"创建房间失败,错误码:\" + ret.errcode);\r\n                }\r\n            }\r\n            else {\r\n                cc.vv.sssNetMgr.connectGameServer(ret);\r\n                // var isConnected = cc.vv.net.isConnected();\r\n                // if (isConnected) {\r\n                //     cc.vv.net.isReonnect = false;\r\n                //     cc.vv.net.close();\r\n                //     cc.vv.emitter.on('disconnect', function(){\r\n                //         cc.vv.sssNetMgr.connectGameServer(ret);\r\n                //         cc.vv.net.isReonnect = true;\r\n                //     });\r\n                // } \r\n                // else {\r\n                //     cc.vv.sssNetMgr.connectGameServer(ret);\r\n                //     cc.vv.net.isReonnect = true;\r\n                // }\r\n            }\r\n        };\r\n\r\n        var conf = null;\r\n        conf = this.constructSCMJConf();\r\n\r\n        var data = {\r\n            account: cc.vv.userMgr.account,\r\n            sign: cc.vv.userMgr.sign,\r\n            serverType:\"SSS_SERVER_TYPE\",\r\n            conf: JSON.stringify(conf)\r\n        };\r\n        console.log(data);\r\n        cc.vv.wc.show(\"正在创建房间\");\r\n        cc.vv.http.sendRequest(\"/create_private_room\", data, onCreate);\r\n    },\r\n    constructSCMJConf: function () {\r\n        var game_list = this.node.getChildByName(\"game_list\");\r\n\r\n        var difen = this.getSelectedOfRadioGroup('difenxuanze');\r\n        var koufeixuanze = this.getSelectedOfRadioGroup('koufeixuanze');\r\n        //霸王庄\r\n        var wanfaxuanze = this.getSelectedOfRadioGroup('wanfaxuanze');\r\n        //底分和局数默认为0\r\n        difen = 0;\r\n        var jushuxuanze = 0;\r\n        var conf = {\r\n            difen:difen,\r\n            jushuxuanze:jushuxuanze,\r\n            wanfa:wanfaxuanze,\r\n            koufeixuanze:koufeixuanze,\r\n        };\r\n        return conf;\r\n    },\r\n\r\n    onBtnCloseClicked:function(){\r\n         this.node.active = false;\r\n    }\r\n\r\n    // called every frame, uncomment this function to activate update callback\r\n    // update: function (dt) {\r\n\r\n    // },\r\n});\r\n"]}